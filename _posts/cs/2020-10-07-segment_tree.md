---
title:  "[java] ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ ìë£Œêµ¬ì¡°"
excerpt: "ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ ìë£Œêµ¬ì¡° ê°œë… ë° ì½”ë“œ"
toc: true
toc_sticky: true
categories:
  - DataStructure
tags:
  - Java
  - DataStructure
---
# ì‘ì„±ì¤‘
## ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ êµ¬ì¡° ê°œë… ë° ì½”ë“œ  
### ê°œë…  
*ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)*ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¨í¸, êµ¬ë¶„ì„ ì €ì¥í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì´ì§„íŠ¸ë¦¬ì´ë‹¤  
ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ê° ë¦¬í”„ëŠ” ë‹¨ì¼ ìš”ì†Œë¥¼ ë‚˜íƒ€ë‚¸ë‹¤  
ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ë‚´ë¶€ ë…¸ë“œëŠ” ê¸°ë³¸ ê°„ê²©ì˜ í•©ì§‘í•©ì„ ë‚˜íƒ€ë‚¸ë‹¤  


![img](/assets/images/post/201007-1.png)  
ìµœìƒë‹¨ ë…¸ë“œëŠ” [0,7]ì²˜ëŸ¼ <ins>0ë²ˆ ë¦¬í”„ë¶€í„° 7ë²ˆ ë¦¬í”„ì˜ í•©</ins>ì„ ê°€ì§€ê³  ìˆë‹¤  
í•˜ìœ„ ë‘ ë…¸ë“œì˜ ê°’ì„ ë£¨íŠ¸ê°€ ê°€ì§€ê³  ìˆëŠ” í˜•íƒœë¥¼ ë„ê³  ìˆë‹¤  

ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ê°€ êµ¬ì¶•ë˜ë©´ êµ¬ì¡°ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤  
ë…¸ë“œê°’ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆì§€ë§Œ, **êµ¬ì¡°ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ë‹¤**  

ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ëŠ” ì¸ë±ìŠ¤ê°€ 1ë¶€í„° ì‹œì‘í•˜ëŠ”ê²Œ í†µìƒì ì´ë‹¤  
ìµœìƒë‹¨ ë…¸ë“œì˜ ì¸ë±ìŠ¤ê°€ kì´ë©´ `2k`ëŠ” kì˜ ì™¼ìª½ ìì‹ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ë¯€ë¡œ íš¨ê³¼ì ì´ê¸° ë•Œë¬¸ì´ë‹¤  

### íŠ¹ì§•  
- ë…¸ë“œì˜ ì™¼ìª½ í•˜ìœ„íŠ¸ë¦¬ì—ëŠ” í•´ë‹¹ ë…¸ë“œì˜ ê°’ë³´ë‹¤ ì‘ì€ ê°’ì„ ì§€ë‹Œ ë…¸ë“œë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤  
- ë…¸ë“œì˜ ì˜¤ë¥¸ìª½ í•˜ìœ„íŠ¸ë¦¬ì—ëŠ” í•´ë‹¹ ë…¸ë“œì˜ ê°’ë³´ë‹¤ í° ê°’ì„ ì§€ë‹Œ ë…¸ë“œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤  
- ë‹¨ì¼ ìš”ì†Œê°€ Nê°œì¼ ë•Œ, ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ ì´ë£¨ëŠ” ì´ ë…¸ë“œì˜ ìˆ˜ëŠ” (Full Binary Tree ê¸°ì¤€)   
  * Nì´ 2ì˜ ì œê³±ê¼´ì¼ë•Œ -> 2*N-1ê°œ
  * Nì´ 2ì˜ ì œê³±ê¼´ì´ ì•„ë‹ë•Œ -> 2^(H+1)-1ê°œ (H = ë†’ì´, log2N)  



## ì½”ë“œ  


### ë°°ì—´ í¬ê¸° ì§€ì •  
```java
int input[] = { 5, 8, 7, 3, 1, 3, 2, 7, 9, 7 };
int N = input.length;
int h = (int) Math.ceil(Math.log(N) / Math.log(2)); // log2(N)
int size = (int) Math.pow(2, h + 1); // -1ì„ í•˜ì§€ì•ŠëŠ” ì´ìœ ëŠ” 1ë¶€í„° ì‹œì‘í•˜ê¸° ìœ„í•´ì„œ 
long tree[] = new long[size];
```


### ì´ˆê¸°í™”  
ìµœìƒë‹¨ ì¸ë±ìŠ¤(1)ì—ì„œ ì¬ê·€ë¥¼ ì´ìš©í•´ ê°’ì„ ì±„ìš°ëŠ” ë°©ë²•ì´ë‹¤  
> init(1, 0, N-1)  
 > 1 : ì„¸ê·¸ë¨¼íŠ¸íŠ¸ë¦¬ ì‹œì‘ì¸ë±ìŠ¤  
 > 0 : ì…ë ¥í•  ë°°ì—´ì˜ ì‹œì‘ì¸ë±ìŠ¤  
 > N-1 : ì…ë ¥í•  ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤  

```java
private static long init(int node, int start, int end) {
	if (start == end) // ë¦¬í”„ë…¸ë“œ(ë‹¨ì¼ì›ì†Œê°’ì¸ ê²½ìš°)
		return tree[node] = input[start];

	int mid = (start + end) / 2;
	return tree[node] = init(node * 2, start, mid) + init(node * 2 + 1, mid + 1, end);
}
```
### êµ¬ê°„ í•© ì°¾ê¸°  
êµ¬í•´ì•¼ í•˜ëŠ” ë²”ìœ„ë¥¼ [left, right]ë¼ê³  í•˜ê³ , ë…¸ë“œê°€ ë‹´ë‹¹í•˜ëŠ” êµ¬ê°„ì´ [start, end]ë¼ê³  í•˜ì  
ìµœìƒë‹¨ ë…¸ë“œì˜ ë‹´ë‹¹êµ¬ê°„ [start, end] ëŠ” [0, N-1]ì´ë‹¤  

ì´ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ 4ê°€ì§€ ê²½ìš°ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤  

1. [left,right]ì™€ [start,end]ê°€ ê²¹ì¹˜ì§€ ì•ŠëŠ” ê²½ìš°  
2. [left,right]ê°€ [start,end]ë¥¼ ì™„ì „íˆ í¬í•¨í•˜ëŠ” ê²½ìš°  
3. [start,end]ê°€ [left,right]ë¥¼ ì™„ì „íˆ í¬í•¨í•˜ëŠ” ê²½ìš°  
4. [left,right]ì™€ [start,end]ê°€ ê²¹ì³ì ¸ ìˆëŠ” ê²½ìš° (1, 2, 3 ì œì™¸í•œ ë‚˜ë¨¸ì§€ ê²½ìš°)  


* > **1. [left,right]ì™€ [start,end]ê°€ ê²¹ì¹˜ì§€ ì•ŠëŠ” ê²½ìš°**  
 ì´ ê²½ìš°ì—ëŠ” `if( left > end || right < start )`ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤  
 ì´ë•ŒëŠ” ê²¹ì¹˜ì§€ ì•Šê¸°ë•Œë¬¸ì— íƒìƒ‰ì„ ì´ì–´ë‚˜ê°€ì§€ì•Šê³  0ì„ ë¦¬í„´í•´ì„œ ì¢…ë£Œí•œë‹¤  

* > **2. [left,right]ê°€ [start,end]ë¥¼ ì™„ì „íˆ í¬í•¨í•˜ëŠ” ê²½ìš°**  
 ì´ ê²½ìš°ì—ëŠ” `if( left <= start && end <= right )`ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤  
 êµ¬í•´ì•¼ í•˜ëŠ” ë²”ìœ„ëŠ” left ~ rightì¸ë° start ~ endëŠ” í•´ë‹¹ ë²”ìœ„ì— ì™„ì „íˆ í¬í•¨ë˜ê³ , start~endì˜ í•˜ìœ„ë…¸ë“œë“¤ë„ ëª¨ë‘ í¬í•¨ì´ê¸° ë•Œë¬¸ì— íƒìƒ‰ì„ ì§„í–‰í•  í•„ìš”ê°€ ì—†ë‹¤. tree[node]ë¥¼ ë¦¬í„´í•´ì„œ ì¢…ë£Œí•œë‹¤  

* > **3. [start,end]ê°€ [left,right]ë¥¼ ì™„ì „íˆ í¬í•¨í•˜ëŠ” ê²½ìš°**  
 > **4. [left,right]ì™€ [start,end]ê°€ ê²¹ì³ì ¸ ìˆëŠ” ê²½ìš° (1, 2, 3 ì œì™¸í•œ ë‚˜ë¨¸ì§€ ê²½ìš°)**  
 ë‘ ê²½ìš°ì—ëŠ” ì™¼ìª½ ìì‹ë…¸ë“œì™€ ì˜¤ë¥¸ìª½ ìì‹ë…¸ë“œë¥¼ ë£¨íŠ¸ë¡œ í•˜ëŠ” íŠ¸ë¦¬ì—ì„œ ë‹¤ì‹œ íƒìƒ‰ì„ ì‹œì‘í•´ì•¼ í•œë‹¤  


* ğŸ’ 3 ~ 6 ê¹Œì§€ êµ¬ê°„í•©ì„ êµ¬í•  ë•Œ
> sum(1, 0, N-1, 3, 6)  
 > 1 : ì„¸ê·¸ë¨¼íŠ¸íŠ¸ë¦¬ ì‹œì‘ì¸ë±ìŠ¤  
 > 0 : ì…ë ¥í•  ë°°ì—´ì˜ ì‹œì‘ì¸ë±ìŠ¤  
 > N-1 : ì…ë ¥í•  ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤  
 > 3 : í•©ì„ êµ¬í•  êµ¬ê°„ì˜ ì²«ë²ˆì§¸ ì›ì†Œ ì¸ë±ìŠ¤  
 > 6 : í•©ì„ êµ¬í•  êµ¬ê°„ì˜ ë§ˆì§€ë§‰ ì›ì†Œ ì¸ë±ìŠ¤  


```java
private static long sum(int node, int start, int end, int left, int right) {
	if (left > end || right < start)
		return 0;
	if (left <= start && end <= right)
		return tree[node];

	int mid = (start + end) / 2;
	return sum(node * 2, start, mid, left, right) + sum(node * 2 + 1, mid + 1, end, left, right);
}
```

### ìˆ˜ ë³€ê²½í•˜ê¸°  
ì¤‘ê°„ì— ì–´ë–¤ ìˆ˜ë¥¼ ë³€ê²½í•˜ë©´, í•´ë‹¹ ìˆ˜ê°€ í¬í•¨ëœ êµ¬ê°„ì„ ë‹´ë‹¹í•˜ëŠ” ë…¸ë“œë¥¼ ëª¨ë‘ ë³€ê²½í•´ì•¼ í•œë‹¤  

ì˜ˆì‹œ ê·¸ë¦¼ì—ì„œ 5ë²ˆì§¸ ì›ì†Œë¥¼ ë³€ê²½í•œë‹¤ê³  í•˜ë©´, ì£¼í™©ìƒ‰ìœ¼ë¡œ ì¹ í•´ì§„ ë¶€ë¶„ì„ ìˆ˜ì •í•´ì¤˜ì•¼í•œë‹¤  
![img](/assets/images/post/201007-2.png)  


ì´ ë•Œ, ì›ì†Œ ê°’ê³¼ ë³€ê²½í•˜ë ¤ëŠ” ê°’ì˜ ì°¨ì´ë¥¼ `diff`ë¼ê³  í•  ë•Œ, ì´ `diff`ë¥¼ ë³€ê²½í•˜ë ¤ëŠ” ì›ì†Œì˜ êµ¬ê°„í•© ê³„ì‚°êµ¬ê°„ì— ì ìš©í•´ì¤˜ì•¼í•œë‹¤  
5ë²ˆì§¸ ì›ì†Œ 5ë¥¼ 7ë¡œ ë³€ê²½í•œë‹¤ê³  í•˜ë©´, `diff = 2`ì´ë‹¤  
ë…¸ë—ê²Œ ì¹ í•´ì§„ êµ¬ê°„ì— ì´ diffë¥¼ ì ìš©í•´ì£¼ë©´ ëœë‹¤  

* ğŸ’ 5ë²ˆì§¸ ì›ì†Œë¥¼ 7ë¡œ ë³€ê²½í•  ë•Œ  
> update(1, 0, N-1, 5, 2)  
 > 1 : ì„¸ê·¸ë¨¼íŠ¸íŠ¸ë¦¬ ì‹œì‘ì¸ë±ìŠ¤  
 > 0 : ì…ë ¥í•  ë°°ì—´ì˜ ì‹œì‘ì¸ë±ìŠ¤  
 > N-1 : ì…ë ¥í•  ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤  
 > 5 : ë³€ê²½í•  ì›ì†Œì˜ ì¸ë±ìŠ¤  
 > 2 : ê¸°ì¡´ ì›ì†Œì™€ ë³€ê²½í•  ì›ì†Œì˜ diffê°’   


 ```java
private static void update(int node, int start, int end, int index, int diff) {
	if (index < start || index > end) // ì¸ë±ìŠ¤ ë²”ìœ„ ì¡°ì •
		return;
	tree[node] += diff; // diff ë³€ê²½ ì ìš©
	if (start != end) {
		int mid = (start + end) / 2;
		update(node * 2, start, mid, index, diff);
		update(node * 2 + 1, mid + 1, end, index, diff);
	}
}
 ```

### ì „ì²´ ì½”ë“œ(github)  
[github - commit](https://github.com/hongjuzzang/hongjuzzang.github.io/commit/289e67b50e66c49e1f3a2b552654fd680418e00f)  

## í’€ ìˆ˜ ìˆëŠ” ë¬¸ì œ  
ê´€ë ¨í•´ì„œ í’€ë§Œí•œ ë¬¸ì œ ëª‡ê°œ ì´ì´  
[ë°±ì¤€ - êµ¬ê°„ í•© êµ¬í•˜ê¸°](https://www.acmicpc.net/problem/2042)  
[ë°±ì¤€ - êµ¬ê°„ ê³± êµ¬í•˜ê¸°](https://www.acmicpc.net/problem/11505)  
[ë°±ì¤€ - ìµœì†Ÿê°’ê³¼ ìµœëŒ“ê°’](https://www.acmicpc.net/problem/2357)  


## ì°¸ê³   
[41. ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)](https://blog.naver.com/ndb796/221282210534)  
[ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)](https://www.acmicpc.net/blog/view/9)  
[[ì•Œê³ ë¦¬ì¦˜] ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ ( Segment Tree )](https://gintrie.tistory.com/31)